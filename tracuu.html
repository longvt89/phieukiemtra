<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tra C·ª©u Th√¥ng Tin Xe</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .container { background-color: #ffffff; padding: 32px; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); width: 100%; max-width: 900px; margin: 20px; }
        .search-button { background-color: #4f46e5; color: #ffffff; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: background-color 0.2s ease-in-out; width: 100%; }
        .search-button:hover { background-color: #4338ca; }
        .loading-spinner { border: 4px solid #f3f3f3; border-top: 4px solid #4f46e5; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .result-section { margin-top: 32px; border-top: 1px solid #e5e7eb; padding-top: 24px; }
        .result-block { background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .result-block h3 { font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 15px; border-bottom: 2px solid #6366f1; padding-bottom: 10px; }
        .history-block { background-color: #fff; border: 1px solid #d1d5db; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .history-block h4 { font-size: 1.1rem; font-weight: 600; color: #374151; margin-bottom: 10px; }
        .result-item { display: flex; flex-wrap: wrap; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px dashed #e5e7eb; }
        .result-item:last-child { border-bottom: none; }
        .result-item strong { flex: 0 0 220px; color: #1f2937; font-weight: 600; }
        .result-item span { flex: 1; color: #4b5563; white-space: pre-wrap; }
        .no-results { color: #ef4444; text-align: center; font-weight: 600; margin-top: 20px; }
        .parsed-service-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em; }
        .parsed-service-table th, .parsed-service-table td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; }
        .parsed-service-table th { background-color: #eef2ff; font-weight: 600; color: #374151; }
        .parsed-service-table td.num-col { text-align: right; white-space: nowrap; }
    </style>
</head>
<body class="flex justify-center items-start min-h-screen">
    <div class="container">
        <h1 class="text-3xl font-bold text-gray-800 mb-2 text-center">Tra C·ª©u Th√¥ng Tin Xe</h1>
        <p class="text-center text-gray-500 mb-8">Nh·∫≠p Bi·ªÉn s·ªë xe ho·∫∑c S·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ t√¨m ki·∫øm.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="input-group">
                <label for="licensePlate" class="block text-sm font-medium text-gray-700">Bi·ªÉn s·ªë xe:</label>
                <input type="text" id="licensePlate" placeholder="V√≠ d·ª•: 51K-123.45" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm">
            </div>
            <div class="input-group">
                <label for="phoneNumber" class="block text-sm font-medium text-gray-700">S·ªë ƒëi·ªán tho·∫°i:</label>
                <input type="text" id="phoneNumber" placeholder="V√≠ d·ª•: 090xxxxxxx" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm">
            </div>
        </div>

        <button id="searchButton" class="search-button">üîç T√¨m Ki·∫øm</button>

        <div id="loadingSpinner" class="loading-spinner"></div>

        <div id="results" class="result-section hidden">
            </div>
    </div>

    <script>
        // !!! QUAN TR·ªåNG: THAY TH·∫æ URL B√äN D∆Ø·ªöI B·∫∞NG URL WEB APP C·ª¶A B·∫†N
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzE44UQR_Mu1M9vAxnY6SmrHq-2hTPIr1I-0rpTztwPoN-PoEL0psVLvXb8HY746mRz/exec';

        // ƒê·ªäNH NGHƒ®A NH√ÉN TI·∫æNG VI·ªÜT CHO T·∫§T C·∫¢ C√ÅC C·ªòT
        const FIELD_LABELS = {
            // Th√¥ng tin chung
            FormType: "Lo·∫°i Phi·∫øu", Timestamp: "Ng√†y T·∫°o", hoten: "T√™n Kh√°ch H√†ng", customerName: "T√™n Kh√°ch H√†ng",
            dienthoai: "S·ªë ƒêi·ªán Tho·∫°i", email: "Email", bienso: "Bi·ªÉn S·ªë Xe", licensePlate: "Bi·ªÉn S·ªë Xe", 
            loaixe: "Lo·∫°i Xe", carModel: "D√≤ng Xe", vehicleTypeYear: "ƒê·ªùi xe", hangXe: "H√£ng Xe",
            sokm: "S·ªë KM", sokmhientai: "S·ªë KM Hi·ªán T·∫°i", mileage: "S·ªë KM", sokmcu: "S·ªë KM C≈©",
            chiNhanh: "Chi Nh√°nh", branch: "Chi Nh√°nh", daiLyPhuTrach: "ƒê·∫°i l√Ω ph·ª• tr√°ch",
            nhanxe: "Ng√†y Nh·∫≠n Xe", giaoxe: "Ng√†y Giao Xe", duKienGiaoXe: "D·ª± Ki·∫øn Giao Xe", 
            inspectionDate: "Ng√†y Ki·ªÉm Tra", receiveDate: "Ng√†y nh·∫≠n", deliverDate: "Ng√†y giao",
            receiptNumber: "S·ªë phi·∫øu", currentMonthYear: "Th√°ng/NƒÉm",
            
            // Th√¥ng tin phi·∫øu
            yeuCauKhachHang: "Y√™u C·∫ßu Kh√°ch H√†ng", customerRequest: "Y√™u C·∫ßu Kh√°ch H√†ng",
            ghiChuChung: "Ghi Ch√∫ Chung", note: "Ghi Ch√∫", other: "Kh√°c",
            advisor: "C·ªë v·∫•n d·ªãch v·ª•", serviceAdvisor: "C·ªë v·∫•n d·ªãch v·ª•", nguoiTiepNhan: "Ng∆∞·ªùi ti·∫øp nh·∫≠n",
            ktv: "K·ªπ thu·∫≠t vi√™n", technician: "K·ªπ thu·∫≠t vi√™n", inspector: "Ng∆∞·ªùi ki·ªÉm tra",
            capDoBaoDuong: "C·∫•p ƒë·ªô b·∫£o d∆∞·ª°ng", chanDoanBanDau: "Ch·∫©n ƒëo√°n ban ƒë·∫ßu",
            
            // Th√¥ng tin l·ªëp (Tire Info)
            sizeLopKhuyenCao: "Size l·ªëp khuy·∫øn c√°o",
            tire_pressure_FL: "√Åp su·∫•t l·ªëp (Tr∆∞·ªõc Tr√°i)", tire_thickness_FL: "ƒê·ªô d√†y gai (Tr∆∞·ªõc Tr√°i)",
            tire_pressure_FR: "√Åp su·∫•t l·ªëp (Tr∆∞·ªõc Ph·∫£i)", tire_thickness_FR: "ƒê·ªô d√†y gai (Tr∆∞·ªõc Ph·∫£i)",
            tire_pressure_RL: "√Åp su·∫•t l·ªëp (Sau Tr√°i)", tire_thickness_RL: "ƒê·ªô d√†y gai (Sau Tr√°i)",
            tire_pressure_RR: "√Åp su·∫•t l·ªëp (Sau Ph·∫£i)", tire_thickness_RR: "ƒê·ªô d√†y gai (Sau Ph·∫£i)",
            tire_pressure_Spare: "√Åp su·∫•t l·ªëp (S∆° cua)", tire_thickness_Spare: "ƒê·ªô d√†y gai (S∆° cua)",
            tire_size_1: "L·ªëp 1 - K√≠ch th∆∞·ªõc", tire_depth_1: "L·ªëp 1 - ƒê·ªô s√¢u gai", tire_pressure_1: "L·ªëp 1 - √Åp su·∫•t", tire_dot_1: "L·ªëp 1 - DATE",
            tire_size_2: "L·ªëp 2 - K√≠ch th∆∞·ªõc", tire_depth_2: "L·ªëp 2 - ƒê·ªô s√¢u gai", tire_pressure_2: "L·ªëp 2 - √Åp su·∫•t", tire_dot_2: "L·ªëp 2 - DATE",
            tire_size_3: "L·ªëp 3 - K√≠ch th∆∞·ªõc", tire_depth_3: "L·ªëp 3 - ƒê·ªô s√¢u gai", tire_pressure_3: "L·ªëp 3 - √Åp su·∫•t", tire_dot_3: "L·ªëp 3 - DATE",
            tire_size_4: "L·ªëp 4 - K√≠ch th∆∞·ªõc", tire_depth_4: "L·ªëp 4 - ƒê·ªô s√¢u gai", tire_pressure_4: "L·ªëp 4 - √Åp su·∫•t", tire_dot_4: "L·ªëp 4 - DATE",
            spare_tire_size: "L·ªëp s∆° cua - K√≠ch th∆∞·ªõc", spare_tire_depth: "L·ªëp s∆° cua - ƒê·ªô s√¢u gai", spare_tire_pressure: "L·ªëp s∆° cua - √Åp su·∫•t", spare_tire_dot: "L·ªëp s∆° cua - DATE",
            tireOverallCondition: "Ghi ch√∫ t√¨nh tr·∫°ng l·ªëp", tireStatusNote: "Ghi ch√∫ t√¨nh tr·∫°ng l·ªëp",

            // Th√¥ng tin phanh (Brake Info)
            front_brake_pad: "M√° phanh tr∆∞·ªõc", rear_brake_pad: "M√° phanh sau",
            brakeNote: "Ghi ch√∫ phanh", brake_recommendation: "Khuy·∫øn ngh·ªã phanh",
            
            // Khuy·∫øn ngh·ªã (Recommendations)
            rec_canchinhthuoclai: "KN: C√¢n ch·ªânh th∆∞·ªõc l√°i", rec_canbangdong: "KN: C√¢n b·∫±ng ƒë·ªông",
            rec_daolop: "KN: ƒê·∫£o l·ªëp", rec_thaythe: "KN: Thay th·∫ø",

            // T·ªïng h·ª£p & Ch·ªØ k√Ω
            tongCong: "T·ªïng C·ªông", tongCongThanhToan: "T·ªïng C·ªông Thanh To√°n",
            khachHangKyTen: "Kh√°ch h√†ng k√Ω t√™n",
            
            // C√°c tr∆∞·ªùng chi ti·∫øt
            chiTietKiemTraAnToan: "Chi Ti·∫øt Ki·ªÉm Tra An To√†n", bangChiTietCongViec: "B·∫£ng Chi Ti·∫øt C√¥ng Vi·ªác",
            thongTinDichVuChiTiet: "Th√¥ng Tin D·ªãch V·ª• Chi Ti·∫øt",
            
            // C√°c tr∆∞·ªùng ki·ªÉm tra g·∫ßm (s·∫Ω hi·ªÉn th·ªã n·∫øu c√≥ gi√° tr·ªã l√† 'X')
            front_rotuyn_lai_trong_thay: "R√¥ tuyn l√°i trong (Tr∆∞·ªõc) - Thay", front_rotuyn_lai_trong_luuy: "R√¥ tuyn l√°i trong (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_rotuyn_lai_ngoai_thay: "R√¥ tuyn l√°i ngo√†i (Tr∆∞·ªõc) - Thay", front_rotuyn_lai_ngoai_luuy: "R√¥ tuyn l√°i ngo√†i (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_rotuyn_tru_tren_thay: "R√¥ tuyn tr·ª• tr√™n (Tr∆∞·ªõc) - Thay", front_rotuyn_tru_tren_luuy: "R√¥ tuyn tr·ª• tr√™n (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_rotuyn_tru_duoi_thay: "R√¥ tuyn tr·ª• d∆∞·ªõi (Tr∆∞·ªõc) - Thay", front_rotuyn_tru_duoi_luuy: "R√¥ tuyn tr·ª• d∆∞·ªõi (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_rotuyn_can_bang_thay: "R√¥ tuyn c√¢n b·∫±ng (Tr∆∞·ªõc) - Thay", front_rotuyn_can_bang_luuy: "R√¥ tuyn c√¢n b·∫±ng (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_rotuyn_pass_lai_phu_thay: "Rotuyn pass l√°i ph·ª• (Tr∆∞·ªõc) - Thay", front_rotuyn_pass_lai_phu_luuy: "Rotuyn pass l√°i ph·ª• (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_cao_su_chu_d_thay: "Cao su ch·ªØ D (Tr∆∞·ªõc) - Thay", front_cao_su_chu_d_luuy: "Cao su ch·ªØ D (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_cao_su_chu_a_tren_thay: "Cao su ch·ªØ A tr√™n (Tr∆∞·ªõc) - Thay", front_cao_su_chu_a_tren_luuy: "Cao su ch·ªØ A tr√™n (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_cao_su_chu_a_duoi_thay: "Cao su ch·ªØ A d∆∞·ªõi (Tr∆∞·ªõc) - Thay", front_cao_su_chu_a_duoi_luuy: "Cao su ch·ªØ A d∆∞·ªõi (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_bo_thang_truoc_thay: "B·ªô th·∫Øng tr∆∞·ªõc - Thay", front_bo_thang_truoc_luuy: "B·ªô th·∫Øng tr∆∞·ªõc - L∆∞u √Ω",
            front_bac_dan_banh_truoc_trai_phai_thay: "B·∫°c ƒë·∫°n b√°nh tr∆∞·ªõc - Thay", front_bac_dan_banh_truoc_trai_phai_luuy: "B·∫°c ƒë·∫°n b√°nh tr∆∞·ªõc - L∆∞u √Ω",
            front_bat_beo_phuoc_truoc_thay: "B√°t b√®o phu·ªôc (Tr∆∞·ªõc) - Thay", front_bat_beo_phuoc_truoc_luuy: "B√°t b√®o phu·ªôc (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_tam_bong_phuoc_truoc_thay: "TƒÉm b√¥ng phu·ªôc (Tr∆∞·ªõc) - Thay", front_tam_bong_phuoc_truoc_luuy: "TƒÉm b√¥ng phu·ªôc (Tr∆∞·ªõc) - L∆∞u √Ω",
            front_phuoc_truoc_trai_phai_thay: "Phu·ªôc tr∆∞·ªõc - Thay", front_phuoc_truoc_trai_phai_luuy: "Phu·ªôc tr∆∞·ªõc - L∆∞u √Ω",
            rear_bo_thang_sau_thay: "B·ªô th·∫Øng sau - Thay", rear_bo_thang_sau_luuy: "B·ªô th·∫Øng sau - L∆∞u √Ω",
            rear_cao_su_chu_d_thay: "Cao su ch·ªØ D (Sau) - Thay", rear_cao_su_chu_d_luuy: "Cao su ch·ªØ D (Sau) - L∆∞u √Ω",
            rear_rotuyn_can_bang_sau_thay: "R√¥ tuyn c√¢n b·∫±ng (Sau) - Thay", rear_rotuyn_can_bang_sau_luuy: "R√¥ tuyn c√¢n b·∫±ng (Sau) - L∆∞u √Ω",
            rear_bac_dan_banh_sau_trai_phai_thay: "B·∫°c ƒë·∫°n b√°nh sau - Thay", rear_bac_dan_banh_sau_trai_phai_luuy: "B·∫°c ƒë·∫°n b√°nh sau - L∆∞u √Ω",
            rear_phuoc_sau_trai_phai_thay: "Phu·ªôc sau - Thay", rear_phuoc_sau_trai_phai_luuy: "Phu·ªôc sau - L∆∞u √Ω",
        };
        
        // C√°c tr∆∞·ªùng n√†y s·∫Ω ƒë∆∞·ª£c ·∫©n ƒëi ƒë·ªÉ tr√°nh hi·ªÉn th·ªã tr√πng l·∫∑p ho·∫∑c kh√¥ng c·∫ßn thi·∫øt
        const IGNORED_FIELDS = new Set([
            'sortTimestamp', 'thongTinDichVuChiTietParsed', 'FormType', 'Timestamp', 'kiemTraAnToan',
            'khachHangKyTen', // ·∫®n v√¨ kh√¥ng c√≥ gi√° tr·ªã th·ª±c
            // ·∫®n c√°c c·ªôt ki·ªÉm tra g·∫ßm chi ti·∫øt, ch·ªâ hi·ªÉn th·ªã c·ªôt c√≥ gi√° tr·ªã
            'front_rotuyn_lai_trong_status', 'front_rotuyn_lai_trong_tot',
            'front_rotuyn_lai_ngoai_status', 'front_rotuyn_lai_ngoai_tot',
            'front_rotuyn_tru_tren_status', 'front_rotuyn_tru_tren_tot',
            'front_rotuyn_tru_duoi_status', 'front_rotuyn_tru_duoi_tot',
            'front_rotuyn_can_bang_status', 'front_rotuyn_can_bang_tot',
            'front_rotuyn_pass_lai_phu_status', 'front_rotuyn_pass_lai_phu_tot',
            'front_cao_su_chu_d_status', 'front_cao_su_chu_d_tot',
            'front_cao_su_chu_a_tren_status', 'front_cao_su_chu_a_tren_tot',
            'front_cao_su_chu_a_duoi_status', 'front_cao_su_chu_a_duoi_tot',
            'front_bo_thang_truoc_status', 'front_bo_thang_truoc_tot',
            'front_bac_dan_banh_truoc_trai_phai_status', 'front_bac_dan_banh_truoc_trai_phai_tot',
            'front_bat_beo_phuoc_truoc_status', 'front_bat_beo_phuoc_truoc_tot',
            'front_tam_bong_phuoc_truoc_status', 'front_tam_bong_phuoc_truoc_tot',
            'front_phuoc_truoc_trai_phai_status', 'front_phuoc_truoc_trai_phai_tot',
            'rear_bo_thang_sau_status', 'rear_bo_thang_sau_tot',
            'rear_cao_su_chu_d_status', 'rear_cao_su_chu_d_tot',
            'rear_rotuyn_can_bang_sau_status', 'rear_rotuyn_can_bang_sau_tot',
            'rear_bac_dan_banh_sau_trai_phai_status', 'rear_bac_dan_banh_sau_trai_phai_tot',
            'rear_phuoc_sau_trai_phai_status', 'rear_phuoc_sau_trai_phai_tot'
        ]);

        const searchButton = document.getElementById('searchButton');
        const licensePlateInput = document.getElementById('licensePlate');
        const phoneNumberInput = document.getElementById('phoneNumber');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const resultsContainer = document.getElementById('results');

        searchButton.addEventListener('click', searchData);
        licensePlateInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') searchData(); });
        phoneNumberInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') searchData(); });

        async function searchData() {
            const plate = licensePlateInput.value.trim();
            const phone = phoneNumberInput.value.trim();

            if (!plate && !phone) {
                alert('Vui l√≤ng nh·∫≠p Bi·ªÉn s·ªë xe ho·∫∑c S·ªë ƒëi·ªán tho·∫°i.');
                return;
            }

            loadingSpinner.style.display = 'block';
            resultsContainer.innerHTML = '';
            resultsContainer.classList.add('hidden');

            try {
                const url = new URL(SCRIPT_URL);
                if (plate) url.searchParams.append('plate', plate);
                if (phone) url.searchParams.append('phone', phone);
                
                const response = await fetch(url);
                const result = await response.json();

                if (result.result === 'success' && result.data && result.data.length > 0) {
                    displayResults(result.data);
                } else if (result.result === 'error') {
                    displayError(result.message);
                } else {
                    displayError('Kh√¥ng t√¨m th·∫•y th√¥ng tin ph√π h·ª£p.');
                }
            } catch (error) {
                console.error('L·ªói khi t√¨m ki·∫øm:', error);
                displayError('ƒê√£ x·∫£y ra l·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.');
            } finally {
                loadingSpinner.style.display = 'none';
            }
        }

        function displayResults(records) {
            resultsContainer.classList.remove('hidden');
            
            // L·∫ßn g·∫ßn nh·∫•t
            const latestRecord = records[0];
            const latestHtml = createRecordDetailHtml(latestRecord, true);
            resultsContainer.insertAdjacentHTML('beforeend', latestHtml);

            // L·ªãch s·ª≠ (n·∫øu c√≥)
            if (records.length > 1) {
                const historyHtml = records.slice(1)
                    .map(record => createRecordDetailHtml(record, false))
                    .join('');
                
                const historyWrapper = `
                    <div class="mt-8">
                        <h2 class="text-2xl font-semibold text-gray-700 mb-4 text-center">L·ªãch s·ª≠ c√°c l·∫ßn tr∆∞·ªõc</h2>
                        ${historyHtml}
                    </div>
                `;
                resultsContainer.insertAdjacentHTML('beforeend', historyWrapper);
            }
        }

        function createRecordDetailHtml(record, isLatest) {
            const blockClass = isLatest ? 'result-block' : 'history-block';
            const titleTag = isLatest ? 'h3' : 'h4';
            const title = isLatest ? 'K·∫øt qu·∫£ m·ªõi nh·∫•t' : 'L·ªãch s·ª≠';

            let detailsHtml = '';
            for (const key in record) {
                // Ch·ªâ hi·ªÉn th·ªã n·∫øu c√≥ gi√° tr·ªã, kh√¥ng n·∫±m trong danh s√°ch ·∫©n v√† kh√¥ng ph·∫£i l√† c·ªôt d·ªãch v·ª• chi ti·∫øt
                if (record.hasOwnProperty(key) && record[key] && !IGNORED_FIELDS.has(key) && !key.startsWith('service_') && !key.startsWith('item_')) {
                    const label = FIELD_LABELS[key] || key; // D·ªãch t√™n c·ªôt sang Ti·∫øng Vi·ªát
                    const value = (record[key] === 'X' || record[key] === 'on') ? 'C√≥' : record[key];

                    detailsHtml += `<div class="result-item"><strong>${label}:</strong> <span>${value}</span></div>`;
                }
            }
            
            // X·ª≠ l√Ω b·∫£ng chi ti·∫øt d·ªãch v·ª• cho Phi·∫øu B·∫£o D∆∞·ª°ng
            if (record.thongTinDichVuChiTietParsed && record.thongTinDichVuChiTietParsed.length > 0) {
                let tableRows = record.thongTinDichVuChiTietParsed.map(item => `
                    <tr>
                        <td>${item.stt}</td>
                        <td>${item.hangMuc}</td>
                        <td>${item.dienGiai}</td>
                        <td class="num-col">${item.soLuong}</td>
                        <td class="num-col">${item.donGia}</td>
                        <td class="num-col">${item.thanhTien}</td>
                    </tr>
                `).join('');

                detailsHtml += `
                    <div class="result-item flex-col items-start mt-4">
                        <strong class="mb-2">Chi Ti·∫øt D·ªãch V·ª•:</strong>
                        <table class="parsed-service-table">
                            <thead>
                                <tr><th>STT</th><th>H·∫°ng m·ª•c</th><th>Di·ªÖn gi·∫£i</th><th>SL</th><th>ƒê∆°n gi√°</th><th>Th√†nh ti·ªÅn</th></tr>
                            </thead>
                            <tbody>${tableRows}</tbody>
                        </table>
                    </div>`;
            }

            return `
                <div class="${blockClass}">
                    <${titleTag}>${title} (${record.FormType || 'N/A'} - ${record.Timestamp || 'N/A'})</${titleTag}>
                    ${detailsHtml}
                </div>
            `;
        }

        function displayError(message) {
            resultsContainer.classList.remove('hidden');
            resultsContainer.innerHTML = `<div class="no-results">${message}</div>`;
        }
    </script>
</body>
</html>
